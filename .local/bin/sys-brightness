#!/bin/sh
#
# Controls the screen brightness.
#
# Dependencies: `fzf`, `brightnessctl`

# Exit if any command fails.
set -e

usage() {
  echo "Usage: $0 [get | up | down]"
}

[ $# -gt 1 ] && usage && exit 1
if [ $# -eq 1 ]; then
  case "$1" in
    get) echo "100 * $(brightnessctl get) / $(brightnessctl max)" | bc ;;
    up) brightnessctl set +5% ;;
    down) brightnessctl set 5%- ;;
    *) usage && exit 1 ;;
  esac
  exit 0
fi

# Starts a looping menu:
# - `nf-md-white_balance_sunny`
# - `nf-oct-sun`
header_cmd="printf '󰖨 Brightness: %s%%' \"\$('$0' get)\""
fzf-menu-loop \
  --bind="start:transform-header(${header_cmd})" \
  --bind="jump:+transform-header(${header_cmd})" << EOF
󰖨 Brightness up	'$0' up
 Brightness down	'$0' down
EOF
